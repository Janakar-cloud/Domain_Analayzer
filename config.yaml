# Domain Intelligence Configuration
# ================================

# Target domains for analysis
targets:
  domains: []  # Add domains here or use CLI --domain flag
  input_file: null  # Or specify a file path with domains

# Module settings
modules:
  ct_enumeration:
    enabled: true
    timeout: 6
    max_subdomains: 400  # Cap processed subdomains to reduce runtime
  
  dns_enumeration:
    enabled: true
    record_types:
      - A
      - AAAA
      - CNAME
      - NS
      - MX
      - TXT
      - SOA
    timeout: 5  # DNS timeout per query
    nameservers:
      - 8.8.8.8
      - 8.8.4.4
      - 1.1.1.1
  
  tls_inspection:
    enabled: true
    timeout: 6
    ports:
      - 443
    check_expiry_days: 30  # Warn if cert expires within X days
  
  whois_lookup:
    enabled: true
    timeout: 9
  
  ssllabs:
    enabled: true
    timeout: 7  # Overall request timeout
    max_age: 48  # hours - prefer cached results to reduce wait
    poll_interval_seconds: 2
    max_attempts: 3  # Aggressive cap; use cache when available
  
  threat_intel:
    abuseipdb:
      enabled: true
      max_age_days: 90  # Report abuse within last X days
    
    alienvault_otx:
      enabled: true
    
    virustotal:
      enabled: true
    
    criminalip:
      enabled: false  # Enable when API key is configured
    
    urlscan:
      enabled: true
      visibility: public  # public or private
      store_screenshots: true

    local_reputation:
      enabled: true  # Local heuristics module (no external APIs)
  
  redirect_analysis:
    enabled: true
    max_redirects: 10
    timeout: 6
    verify_ssl: true  # SSL verification enabled by default for security
  
  content_scanner:
    enabled: true
    timeout_seconds: 6
    max_redirects: 10
    max_body_bytes: 1048576
    shallow_links_limit: 10
    deep_scan: true

  takeover_detection:
    enabled: true

# Rate limiting (requests per minute)
rate_limits:
  crtsh: 30
  dns: 100
  whois: 10
  ssllabs: 2
  abuseipdb: 60
  alienvault_otx: 10
  virustotal: 4
  criminalip: 10
  urlscan: 2

# Concurrency settings
concurrency:
  max_workers: 10
  batch_size: 50

# Output settings
output:
  directory: ./output
  evidence_directory: ./evidence
  formats:
    - json
    - csv
    - html
  include_raw_responses: false
  timestamp_format: "%Y-%m-%d_%H-%M-%S"

# Logging settings
logging:
  level: DEBUG  # DEBUG, INFO, WARNING, ERROR
  format: json  # json or text
  file: ./logs/domain_intel.log
  max_size_mb: 10
  backup_count: 5

# Proxy settings (optional)
proxy:
  enabled: false
  http: null
  https: null

# Custom user agent
user_agent: "DomainIntelligence/1.0 (Security Assessment Tool)"

# Local rules file (allow/deny lists, sensitive patterns)
rules:
  path: ./local_rules.yaml

# Email/SMTP settings (configure here for email reports)
email:
  smtp_server: "smtp.gmail.com"
  smtp_port: 587
  sender_email: ""  # Your email address
  sender_password: ""  # App password (not regular password)
  use_tls: true
